% -----
% Pacotes necessários para a definição de comandos
% -----
\usepackage{xparse}
% -----

% -----
% Flags e outras variáveis de decisão
% -----
\newif\ifDefinidoSubtitulo{} \DefinidoSubtitulofalse{}

\newif\ifDefinidoEspecializacao{} \DefinidoEspecializacaofalse{}

\newif\ifDefinidoMestrado{} \DefinidoMestradofalse{}
\newif\ifDefinidoDoutorado{} \DefinidoDoutoradofalse{}
% -----

% -----
% Variáveis de texto
% -----

% --- Título ---
\gdef\ValorDoTitulo{\imprimirtitulo}

\def\subtitulo#1{\gdef\ValorDoSubtitulo{#1}\DefinidoSubtitulotrue}

% --- Trabalho ---

\def\curso#1{\gdef\ValorDoCurso{#1}}

\def\dia#1{\gdef\ValorDoDia{#1}}
\def\mes#1{\gdef\ValorDoMes{#1}}
\def\ano#1{\gdef\ValorDoAno{#1}}
\gdef\ValorDaData{\ValorDoMes{}, \ValorDoAno{}}
\data{\ValorDaData}

\gdef\ValorDoLocal{\imprimirlocal}

% -- Tipo do trabalho --

\def\grau#1{\gdef\ValorDoGrau{#1}}

\def\diploma#1{\gdef\ValorDoDiploma{#1}}

\def\departamento#1{\gdef\ValorDoDepartamento{#1}}

\def\tipoInterno#1{\gdef\ValorDoTipo{#1}}

\def\defineBacharelado{\grau{BACHAREL} \tipoInterno{Monografia} \diploma{Bacharelado} }

\def\defineLicenciatura{\grau{LICENCIADO} \tipoInterno{Monografia} \diploma{Licenciatura} }

\def\defineEspecializacao{\grau{ESPECIALISTA} \tipoInterno{Monografia} \diploma{Especializa\c{c}\~ao} \DefinidoEspecializacaotrue}

\def\defineMestrado{\grau{MESTRE} \tipoInterno{Disserta\c{c}\~{a}o} \diploma{Mestrado} \DefinidoMestradotrue}

\def\defineDoutorado{\grau{DOUTOR} \tipoInterno{Tese} \diploma{Doutorado} \DefinidoDoutoradotrue}

\ExplSyntaxOn%
\NewDocumentCommand{\checkTipo}{m}{%
    \str_case:nn {#1} {%
        {bacharelado} {\defineBacharelado{}}
            {licenciatura} {\defineLicenciatura{}}
            {especializacao} {\defineEspecializacao{}}
            {mestrado} {\defineMestrado{}}
            {doutorado} {\defineDoutorado{}}
            {default} {%
                \msg_error:nnn {custom} {invalid-option} {#1}
            }
    }
}

% Custom error message
\msg_new:nnn {custom} {invalid-option}
{%
    A~opção~``#1''~é~inválida.
    Opções~válidas~são:~bacharelado,~licenciatura,~especializacao,~mestrado,~doutorado.
}
\ExplSyntaxOff%

\def\tipo#1{%
    \checkTipo{#1}%
}

% -----
